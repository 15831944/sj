class([stack]m'math:) {
  this
}

class_bar([heap]x'i32:) {
  [heap]class_foo([stack]this : class_foo(
    parent: [stack]this,
    [heap]x'i32 : this.x
  ))
}

class_foo([heap]x'i32:) {
  if this.x > 0 {
    [heap]class_bar([stack]this : class_bar(
      parent: [stack]this,
      [heap]x'i32 : math_sub([stack]this : math_sub(
        [heap]x'i32 : this.x,
        [heap]y'i32 : 1
      ))
    ))
  } else {
    0
  }
}

math() {
  this
}

math_sub([heap]x'i32:, [heap]y'i32:) {
  this.x - this.y
}

global {
  [stack]c'class : [stack]class([stack]this : class(
    [stack]m'math : [stack]math([stack]this : math())
  ))
  [heap]class_foo([stack]this : class_foo(
    parent: [stack]c,
    [heap]x'i32 : 4
  ))
  void
}

